<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="lib/bulma/css/bulma.css" rel="stylesheet" type="text/css"/>
    </head>
    <body>
                                    
        <a href="https://github.com/login/oauth/authorize?client_id=a36d2aaa108e16bb3604" style="margin: 2em"class="button is-link is-outlined ">Logga in</a>



        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/purl/2.3.1/purl.min.js"></script>
        <script>
            document.body.onload = init;

            function init(){
                if(localStorage.getItem("token")){
                    var url = "http://localhost:8080/OAuth/api/login?token="
                            + localStorage.getItem("token");
                    $.get(url,(data) => {
                        console.log(data);
                        alert("Welcome " + data.login + ", your id is " + data.id);
                    })
                }
                if($.url().param("code") !== undefined){
                    var url = "http://localhost:8080/OAuth/api/token?code="
                            + $.url().param("code");
                    $.get(url,function (data){
                        localStorage.setItem("token",data);
                    })
                }
            }
        </script>
    </body>
</html>